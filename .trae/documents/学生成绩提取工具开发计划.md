# 学生成绩提取工具开发计划

## 项目概述

在 `d:\lesson_zp\zhuabao` 目录下开发一个基于 React + Node.js 的学生成绩提取工具，从成绩查询网站中提取平时分和期末考试分。

## 技术架构

* **前端**: React 19 + Vite + Tailwind CSS (复用现有技术栈)

* **后端**: Node.js + Express + Puppeteer (浏览器自动化)

* **数据导出**: xlsx 库 (Excel导出) + csv-writer (CSV导出)

## 开发步骤

### 1. 项目初始化

* 创建项目目录结构

* 配置 package.json 和依赖

* 设置 Vite 配置

### 2. 后端开发 - 网络抓包模块

* **Puppeteer 集成**: 使用 Puppeteer 自动化浏览器操作

* **网络请求拦截**: 监听和拦截目标网站的 API 请求

* **数据提取**: 从响应中提取平时分和期末考试分

* **反爬处理**: 添加随机延迟、User-Agent 轮换等策略

* **API 接口**: 提供 `/api/grades` 端点供前端调用

### 3. 前端开发 - UI 展示模块

* **成绩表格组件**: 展示课程名称、平时分、期末分、总分

* **数据刷新功能**: 支持手动刷新和自动监控

* **状态管理**: 使用 React Hooks 管理加载状态、错误处理

* **响应式设计**: 适配不同屏幕尺寸

### 4. 数据导出功能

* **Excel 导出**: 使用 xlsx 库生成 .xlsx 文件

* **CSV 导出**: 使用 csv-writer 生成 .csv 文件

* **导出按钮**: 在 UI 中添加导出选项

### 5. 实时监控模块

* **自动刷新**: 支持定时自动获取最新成绩

* **数据对比**: 检测成绩变化并提示用户

* **WebSocket**: 可选的实时推送功能

## 文件结构

```
zhuabao/
├── frontend/                 # 前端应用
│   ├── src/
│   │   ├── components/
│   │   │   ├── GradeTable.jsx      # 成绩表格组件
│   │   │   ├── ExportButton.jsx    # 导出按钮组件
│   │   │   └── StatusIndicator.jsx # 状态指示器
│   │   ├── services/
│   │   │   └── gradeAPI.js         # 成绩API调用
│   │   └── App.jsx                 # 主应用
│   ├── package.json
│   └── vite.config.js
├── backend/                  # 后端服务
│   ├── src/
│   │   ├── controllers/
│   │   │   └── gradeController.js  # 成绩控制器
│   │   ├── services/
│   │   │   ├── puppeteerService.js # Puppeteer服务
│   │   │   └── gradeParser.js      # 数据解析服务
│   │   ├── routes/
│   │   │   └── index.js            # 路由配置
│   │   └── index.js                # 服务器入口
│   └── package.json
└── README.md                  # 使用说明文档
```

## 核心功能实现

1. **网络抓包**: 使用 Puppeteer 的 `page.on('response')` 监听网络请求
2. **数据解析**: 正则表达式或 DOM 解析提取成绩数据
3. **UI 展示**: 表格展示，支持排序和筛选
4. **导出功能**: 前端调用后端 API 生成文件并下载

## 交付成果

* ✅ 完整的源代码（前端 + 后端）

* ✅ 详细的使用说明文档（README.md）

* ✅ 测试报告（验证稳定性和准确性）

## 注意事项

* 遵守目标网站的使用条款

* 实现合理的请求频率限制

* 添加错误处理和重试机制

* 确保数据提取不影响原网站正常使用

